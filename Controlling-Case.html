function renderProjektList() {
    const tbody = document.getElementById('projekt-list-tbody');
    if (!tbody) {
        console.error('FEHLER: projekt-list-tbody nicht gefunden!');
        return;
    }
    
    tbody.innerHTML = '';
    
    const projekte = Object.values(cfoDashboard.projektData);
    console.log('Anzahl Projekte:', projekte.length);
    
    // Empty State
    if (projekte.length === 0) {
        tbody.innerHTML = `
            <tr>
                <td colspan="8" style="padding: 60px; text-align: center;">
                    <div style="color: var(--gray);">
                        <div style="font-size: 64px; margin-bottom: 16px;">üìÅ</div>
                        <div style="font-size: 18px; font-weight: 600; margin-bottom: 8px;">Noch keine Projekte vorhanden</div>
                        <div style="font-size: 14px; margin-bottom: 24px;">Legen Sie Ihr erstes Projekt an, um zu beginnen.</div>
                        <button onclick="addNewProjekt()" 
                                style="padding: 12px 24px; background: var(--primary); color: white; border: none; border-radius: 8px; font-size: 14px; cursor: pointer; font-weight: 500;">
                            + Neues Projekt anlegen
                        </button>
                    </div>
                </td>
            </tr>
        `;
        updateProjektStats();
        return;
    }
    
    // Rendere jedes Projekt
    projekte.forEach(projekt => {
        try {
            // Datum formatieren
            let startDate = '-';
            let endDate = '-';
            
            try {
                const startValue = projekt.startDatum || projekt.start_date || projekt.startDate;
                const endValue = projekt.endDatum || projekt.end_date || projekt.endDate;
                
                if (startValue) startDate = formatDateSafe(startValue);
                if (endValue) endDate = formatDateSafe(endValue);
            } catch(e) {
                console.error('Datum-Fehler:', e);
            }
            
            // Status-Farben
            const statusKey = (projekt.status || 'aktiv').toLowerCase().replace(/\s/g, '-');
            const statusColors = {
                'aktiv': { bg: '#dcfce7', text: '#059669' },
                'on-hold': { bg: '#fef3c7', text: '#d97706' },
                'konzept': { bg: '#dbeafe', text: '#0284c7' },
                'kritisch': { bg: '#fee2e2', text: '#dc2626' },
                'abgeschlossen': { bg: '#f1f5f9', text: '#64748b' }
            };
            const statusColor = statusColors[statusKey] || statusColors['aktiv'];
            
            // Erstelle die komplette Zeile als String
            const rowHTML = `
                <tr class="projekt-row" data-projekt-id="${projekt.id}" 
                    style="cursor: pointer; transition: background 0.2s; border-bottom: 1px solid #f1f5f9;"
                    onmouseover="this.style.background='#f8fafc'" 
                    onmouseout="this.style.background='transparent'">
                    <td style="padding: 12px; text-align: center;" onclick="event.stopPropagation();">
                        <input type="checkbox" class="projekt-checkbox" value="${projekt.id}" 
                               onchange="updateBulkActions()" style="cursor: pointer;">
                    </td>
                    <td style="padding: 12px; font-weight: 500; color: var(--text); font-size: 13px;" 
                        onclick="openProjektArtikel('${projekt.id}')">
                        üìÅ ${projekt.name || 'Unbenannt'}
                    </td>
                    <td style="padding: 12px; font-size: 12px; color: var(--gray);">
                        ${projekt.division || projekt.businessUnit || projekt.business_unit || '-'}
                    </td>
                    <td style="padding: 12px; font-size: 12px; color: var(--text);">
                        ${projekt.owner || projekt.project_owner || '-'}
                    </td>
                    <td style="padding: 12px; text-align: center; font-size: 12px; color: var(--gray);">
                        ${startDate}
                    </td>
                    <td style="padding: 12px; text-align: center; font-size: 12px; color: var(--gray);">
                        ${endDate}
                    </td>
                    <td style="padding: 12px; text-align: center;">
                        <span style="padding: 4px 10px; background: ${statusColor.bg}; color: ${statusColor.text}; 
                              border-radius: 12px; font-size: 11px; font-weight: 500; display: inline-flex; 
                              align-items: center; gap: 4px;">
                            <span style="font-size: 8px;">‚óè</span>
                            ${projekt.status || 'Aktiv'}
                        </span>
                    </td>
                    <td style="padding: 12px; text-align: center;" onclick="event.stopPropagation();">
                        <button onclick="openProjektArtikel('${projekt.id}')" 
                                style="padding: 4px 8px; border: 1px solid var(--border); background: white; 
                                       border-radius: 4px; font-size: 16px; cursor: pointer; margin-right: 4px;"
                                title="Projekt anzeigen">
                            üëÅÔ∏è
                        </button>
                        <button onclick="deleteProjekt('${projekt.id}')" 
                                style="padding: 4px 8px; border: 1px solid var(--danger); background: white; 
                                       color: var(--danger); border-radius: 4px; font-size: 16px; cursor: pointer;"
                                title="Projekt l√∂schen">
                            üóëÔ∏è
                        </button>
                    </td>
                </tr>
            `;
            
            // F√ºge die Zeile ein
            tbody.insertAdjacentHTML('beforeend', rowHTML);
            
        } catch(e) {
            console.error('Fehler beim Rendern von Projekt:', projekt.name, e);
        }
    });
    
    updateProjektStats();
}
